openapi: 3.0.1
info:
  title: Structural Certainty API
  version: "1.0"

servers:
  - url: https://gpt-1-mu.vercel.app

paths:
  /api/structural-certainty/daily:
    post:
      summary: Daily structural certainty
      operationId: dailyCertainty
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SymbolRequest"
      responses:
        "200":
          description: Daily regime and bias
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CertaintyResponse"

  /api/structural-certainty/swingscanner:
    post:
      summary: Swing permission check
      operationId: swingCertainty
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SymbolRequest"
      responses:
        "200":
          description: Swing eligibility
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CertaintyResponse"

components:
  schemas:
    SymbolRequest:
      type: object
      required: [symbol]
      properties:
        symbol:
          type: string
          example: IWM

    CertaintyResponse:
      type: object
      properties:
        symbol:
          type: string
        mode:
          type: string
          enum: [DAILY, SWING]
        regime:
          type: string
          enum: [BULL_CONTROLLED, BEAR_CONTROLLED, NEUTRAL]
        direction:
          type: string
          enum: [LONG_BIAS, SHORT_BIAS, NO_TRADE]
        pc_ratio:
          type: number
        calls_total:
          type: number
        puts_total:
          type: number
        max_pain:
          type: number
        allowed:
          type: boolean
        reason:
          type: string
